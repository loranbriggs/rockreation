%p#notice= notice

%p
  %b Event name:
  = @event.name

%p
  %b Event date:
  = @event.date

%p
  %b Participants
  = @event.participants

%br
- if @event.event_type == 'Party' && ( current_user.role == 'employee' || current_user.role == 'admin')
  %h3 Shifts
  
  %table#shifts.table.table-striped.table-bordered
    %tr
      %th Name
      %th
    - @shifts.each do |shift|
      %tr
      %td= shift.event.name
      %td= shift.event.date.strftime("%a %b %d, %Y")
      - if shift.user_id?
        %td= shift.user.fname
      - else
        %td open
      - if shift.drop && shift.user_id == current_user.id
        %td Shift Dropped Pending
      - elsif shift.drop || shift.user_id.nil?
        %td= link_to 'Take Shift', shift, method: :put, data: { confirm: 'Are you sure you wish to take this shift? You will immediately be responsible for it. This cannot be undone.' }, :class => 'btn btn-success btn-small'
      - elsif current_user.id == shift.user_id
        %td= link_to 'Drop Shift', shift, method: :put, data: { confirm: 'You may dropped this shift, but unless someone else takes it, you are still responsible for it.' }, :class => 'btn btn-danger btn-small'
      - else
        %td covered
      - unless current_user.nil?
        - if current_user.role == 'admin'
          %td= link_to 'Delete', @shift, method: :delete, data: { confirm: 'Are you sure?' } 
- if @event.event_type != 'Party'
  %h3 Class Seats

  %table#seats.table.table-striped.table-bordered
    %tr
      %th Name
      %th
      %th
      %th
    - @seats.each do |seat|
      %tr
      %td= seat.event.name
      %td= seat.event.date.strftime("%a %b %d, %Y")
      - if seat.user_id?
        %td= seat.user.fname
      - else
        %td open
      - if seat.drop && seat.user_id == current_user.id
        %td Seat Dropped Pending
      - elsif seat.drop || seat.user_id.nil?
        %td= link_to 'Take Seat', seat, method: :put, data: { confirm: 'Are you sure you wish to take this seat? You will immediately be responsible for it. This cannot be undone.' }, :class => 'btn btn-success btn-small'
      - elsif current_user.id == seat.user_id
        %td= link_to 'Drop Seat', seat, method: :put, data: { confirm: 'You may dropped this seat, but unless someone else takes it, you are still responsible for it.' }, :class => 'btn btn-danger btn-small'
      - else
        %td covered
      - unless current_user.nil?
        - if current_user.role == 'admin'
          %td= link_to 'Delete', @shift, method: :delete, data: { confirm: 'Are you sure?' }
= link_to 'Back', reservations_path
